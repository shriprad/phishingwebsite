<div class="search-box">
    <form method="POST" class="input-group">
        <input type="text" name="url" placeholder="Enter URL to analyze..." required>
        <button type="submit">Analyze</button>
    </form>
    <button id="fetch-btn">Fetch</button>
</div>

<div id="fetch-loading" class="loading">
    Fetching AWS-hosted phishing URLs...
</div>

<div id="fetch-result" class="analysis-result"></div>

<script>
    document.getElementById('fetch-btn').addEventListener('click', async () => {
        const loading = document.getElementById('fetch-loading');
        const result = document.getElementById('fetch-result');

        loading.classList.add('active');
        result.innerHTML = ''; // Clear previous results

        try {
            const response = await fetch('/fetch');
            const data = await response.json();

            if (data.error) {
                result.innerHTML = `<div class="error-message">${data.error}</div>`;
            } else if (data.aws_urls && data.aws_urls.length) {
                result.innerHTML = `
                    <div class="url-components">
                        <h2>AWS-Hosted Phishing URLs</h2>
                        <ul>${data.aws_urls.map(url => `<li>${url}</li>`).join('')}</ul>
                    </div>`;
            } else {
                result.innerHTML = `<div class="analysis-content">No AWS-hosted phishing URLs found.</div>`;
            }
        } catch (err) {
            result.innerHTML = `<div class="error-message">Error fetching data: ${err.message}</div>`;
        } finally {
            loading.classList.remove('active');
        }
    });
</script>
