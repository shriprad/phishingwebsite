<!DOCTYPE html>
<html lang="en">
<!-- Previous head content remains the same -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Phishing URL Analyzer</title>
    <style>
        /* Previous styles remain the same */
        .url-item {
            background-color: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            margin-bottom: 8px;
            padding: 12px;
        }

        .url-main {
            font-weight: 500;
            word-break: break-all;
            margin-bottom: 4px;
        }

        .url-details {
            font-size: 0.875rem;
            color: #64748b;
        }

        .highlight {
            background-color: #fef3c7;
            padding: 0 2px;
            border-radius: 2px;
        }

        .no-results {
            text-align: center;
            padding: 2rem;
            color: #64748b;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Advanced Phishing URL Analyzer</h1>
        
        <div class="search-box">
            <form method="POST" class="input-group">
                <input type="text" name="url" placeholder="Enter URL to analyze..." required>
                <button type="submit">Analyze</button>
            </form>
            <button id="fetchUrls" class="fetch-button">
                <span class="button-content">
                    <span id="buttonText">Fetch AWS URLs</span>
                </span>
            </button>
            <div id="fetchedUrls" class="fetched-urls" style="display: none;">
                <h3>AWS-Related URLs Found:</h3>
                <div id="urlStats" class="url-stats"></div>
                <div id="urlList" class="url-list"></div>
            </div>
        </div>

        <!-- Rest of the template remains the same -->

        <script>
            document.querySelector('form').addEventListener('submit', function() {
                document.getElementById('loading').classList.add('active');
            });

            document.getElementById('fetchUrls').addEventListener('click', async function() {
                const button = this;
                const buttonText = document.getElementById('buttonText');
                const originalText = buttonText.textContent;
                
                try {
                    // Update button state
                    button.disabled = true;
                    buttonText.innerHTML = '<span class="loading-spinner"></span>Fetching URLs...';
                    
                    const response = await fetch('/fetch-urls');
                    const data = await response.json();
                    
                    if (data.urls) {
                        const urlList = document.getElementById('urlList');
                        const urlStats = document.getElementById('urlStats');
                        urlList.innerHTML = '';
                        
                        // Update stats
                        urlStats.innerHTML = `
                            Total URLs scanned: ${data.total_urls}<br>
                            AWS-related URLs found: ${data.aws_urls_count}
                        `;
                        
                        if (data.urls.length === 0) {
                            urlList.innerHTML = `
                                <div class="no-results">
                                    No AWS-related URLs found in the current feed.
                                </div>
                            `;
                        } else {
                            // Add URLs to list with details
                            data.urls.forEach(urlData => {
                                const div = document.createElement('div');
                                div.className = 'url-item';
                                div.innerHTML = `
                                    <div class="url-main">${urlData.url}</div>
                                    <div class="url-details">
                                        ${urlData.subdomain ? `Subdomain: <span class="highlight">${urlData.subdomain}</span><br>` : ''}
                                        Domain: <span class="highlight">${urlData.domain}</span><br>
                                        ${urlData.path ? `Path: <span class="highlight">${urlData.path}</span>` : ''}
                                    </div>
                                `;
                                urlList.appendChild(div);
                            });
                        }
                        
                        document.getElementById('fetchedUrls').style.display = 'block';
                    }
                } catch (error) {
                    console.error('Error fetching URLs:', error);
                    alert('Error fetching URLs. Please try again.');
                } finally {
                    // Reset button state
                    button.disabled = false;
                    buttonText.textContent = originalText;
                }
            });
        </script>
    </div>
</body>
</html>
